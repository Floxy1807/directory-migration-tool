# 使用指南

以下内容整合自原 `使用说明.md` 与 `快速参考.md`，并统一为 WPF 版本。

## 快速开始

### 1. PowerShell CLI（最快上手）
```powershell
# 以管理员身份运行 PowerShell
./MoveWithSymlink.ps1 -Source "C:\要迁移的目录" -Target "D:\目标位置"
```

可选参数：
```powershell
-LargeFileThresholdMB 1024    # 大文件阈值，默认 1024MB (1GB)
-RobocopyThreads 8            # 复制线程数，默认 8
-SampleMilliseconds 1000      # 进度刷新间隔，默认 1000ms
```

### 2. WPF GUI（推荐分发）
```powershell
# 直接运行（自动申请管理员权限）
./MoveWithSymlinkWPF/bin/publish/win-x64/目录迁移工具.exe

# 或使用启动脚本
./run.ps1
```

## GUI 使用流程

1) 选择路径：选择源/目标目录，配置大文件阈值与线程数
2) 扫描分析：统计文件数与大小、检查目标磁盘空间
3) 执行迁移：实时进度、速度、ETA、日志；可取消
4) 完成：显示结果与统计，失败自动回滚

## 安全机制

- 阻止迁移：`C:\Windows`、`C:\Program Files`、`C:\Program Files (x86)`、`C:\ProgramData\Microsoft`
- 云盘目录：显示警告
- 回滚：任一步失败自动回滚，原路径保持可用

## 常见问题（节选）

- 需要管理员权限吗？创建符号链接需要。WPF 版本已内嵌 UAC 提权。
- 没装 .NET 能运行吗？自包含发布可以，无需预装 .NET。
- 复制多久？取决于磁盘与数据量，GUI 显示速度与 ETA。

## 常用命令速查

```powershell
# 还原/构建
dotnet restore
dotnet build -c Release

# 运行 GUI（开发调试）
cd MoveWithSymlinkWPF
dotnet run -c Release

# 发布单文件（自包含）
dotnet publish MoveWithSymlinkWPF/MoveWithSymlinkWPF.csproj -p:PublishProfile=win-x64 -c Release

# CLI 示例
./MoveWithSymlink.ps1 -Source "C:\Src" -Target "D:\Dst"
```

## 最佳实践

- 开始前备份重要数据；确保目标磁盘空间 ≥ 源大小 + 10%
- 关闭占用目录的应用；优先使用 NTFS 目标盘
- 大目录可提升线程数（如 16）；完成后测试应用可用性

